# 服务探活

## 什么是服务探活

通过某种机制去自动测试某个服务的健康状态（是否挂了，响应有多快）的机制就是服务的探活。

## 为什么需要进行服务探活

1、通过自动测试某个服务的健康状态（是否挂了，响应有多快），我们可以第一时间知道潜在问题，将问题影响降低到最低，提升用户体验。

2、无感发布

## 如何做

1、每个服务对外提供一个健康检查的接口

> 当服务可用时返回200状态，不可用时返回499(可以是其它状态码)

2、业务网关定时检查服务的健康情况

比如每1秒向下流的业务API发起健康检查接口调用，如果返回健康确保这台机器在可用服务机器列表中，如果返回健康为不可用需要从可用服务机器列表中删除。

> 下图是一个大概的上线流程图，体现了服务在发版过程中是怎么做到无损流量的。

![](../readmeimg/deployHealth.jpg)

